/* CSS Variables - Minimal Black Theme */
:root {
  /* Background Color - can be changed via settings */
  --background-color: #0f0f0f;
  --background-rgb: 15, 15, 15;

  /* Foreground Color - can be changed via settings */
  /* Used for text, borders, etc. at varying opacities */
  --foreground-color: #ffffff;
  --foreground-rgb: 255, 255, 255;

  /* Foreground opacity variants - derived from foreground color */
  --fg-100: rgba(var(--foreground-rgb), 1);      /* Primary text */
  --fg-90: rgba(var(--foreground-rgb), 0.9);     /* Near-primary text */
  --fg-80: rgba(var(--foreground-rgb), 0.8);     /* Strong text */
  --fg-70: rgba(var(--foreground-rgb), 0.7);     /* Secondary text */
  --fg-60: rgba(var(--foreground-rgb), 0.6);     /* Tertiary text */
  --fg-50: rgba(var(--foreground-rgb), 0.5);     /* Muted text */
  --fg-40: rgba(var(--foreground-rgb), 0.4);     /* Disabled/hint text */
  --fg-30: rgba(var(--foreground-rgb), 0.3);     /* Strong borders */
  --fg-25: rgba(var(--foreground-rgb), 0.25);    /* Default borders */
  --fg-20: rgba(var(--foreground-rgb), 0.20);     /* Subtle borders */
  --fg-15: rgba(var(--foreground-rgb), 0.15);     /* Very subtle borders */
  --fg-10: rgba(var(--foreground-rgb), 0.10);     /* Faint borders/backgrounds */
  --fg-08: rgba(var(--foreground-rgb), 0.08);    /* Hover backgrounds */
  --fg-05: rgba(var(--foreground-rgb), 0.05);    /* Subtle hover */
  --fg-02: rgba(var(--foreground-rgb), 0.02);    /* Very subtle backgrounds */

  /* Background opacity variants - derived from background color */
  --bg-100: rgba(var(--background-rgb), 1);      /* Solid background */
  --bg-95: rgba(var(--background-rgb), 0.95);    /* Near-solid */
  --bg-90: rgba(var(--background-rgb), 0.9);     /* Near-solid */
  --bg-80: rgba(var(--background-rgb), 0.8);     /* Strong overlay */
  --bg-60: rgba(var(--background-rgb), 0.6);     /* Medium overlay */
  --bg-50: rgba(var(--background-rgb), 0.5);     /* Half overlay */
  --bg-30: rgba(var(--background-rgb), 0.3);     /* Light overlay */
  --bg-20: rgba(var(--background-rgb), 0.2);     /* Subtle overlay */

  /* Brightened background variants - mix background with white, then apply opacity */
  --bg-brighter: color-mix(in srgb, var(--background-color) 90%, var(--foreground-color) 10%);
  --bg-brighter-alpha: color-mix(in srgb, var(--bg-brighter) 50%, transparent 50%);

  /* Darkened background overlay - use for container backgrounds */
  --bg-overlay: linear-gradient(var(--bg-20), var(--bg-20)), #000000;

  /* Accent Color - can be changed via settings */
  --accent-color: #ff9999;
  --accent-rgb: 255, 153, 153;

  /* Code color - 50/50 blend of accent and foreground */
  --code-color: color-mix(in srgb, var(--accent-color) 50%, var(--foreground-color) 50%);

  /* Positive/Negative Colors - can be changed via settings */
  --positive-color: #99ff99;  /* default green for additions/success */
  --positive-rgb: 153, 255, 153;
  --negative-color: #ff9999;  /* default red for removals/changes */
  --negative-rgb: 255, 153, 153;

  /* Legacy aliases for compatibility */
  --color-cyan: var(--positive-color);
  --color-magenta: var(--negative-color);
  --color-cyan-rgb: var(--positive-rgb);
  --color-magenta-rgb: var(--negative-rgb);

  /* Base Colors - now derived from background */
  --color-bg-primary: var(--background-color);
  --color-bg-secondary: var(--background-color);
  --color-bg-tertiary: var(--background-color);
  --color-bg-elevated: var(--background-color);

  /* Borders - now derived from foreground */
  --color-border-subtle: var(--fg-10);
  --color-border-default: var(--fg-15);
  --color-border-strong: var(--fg-25);

  /* Text - now derived from foreground */
  --color-text-primary: var(--fg-100);
  --color-text-secondary: var(--fg-60);
  --color-text-tertiary: var(--fg-40);
  --color-text-disabled: var(--fg-25);

  /* Accent Colors */
  --color-accent-blue: #3b82f6;
  --color-accent-green: #10b981;
  --color-accent-red: #ef4444;
  --color-accent-yellow: #f59e0b;
  --color-accent-purple: #8b5cf6;

  /* Interactive States - now derived from foreground */
  --color-hover: var(--fg-05);
  --color-active: var(--fg-15);
  --color-focus: rgba(59, 130, 246, 0.5);
  --color-selection: rgba(var(--accent-rgb), 0.2);
  
  /* Shadows */
  --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.5);
  --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.5);
  --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.5);
  --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.5);
  
  /* Typography - Default fallbacks, overridden by fonts.css based on platform */
  --font-sans: 'Agave', 'Inter', 'Helvetica Neue', 'Segoe UI', 'Arial', 'Helvetica', 'Calibri', 'Tahoma', 'Verdana', -apple-system, BlinkMacSystemFont, 'Microsoft Sans Serif', sans-serif;
  --font-mono: 'Agave', 'Fira Code', 'Cascadia Code', 'Consolas', 'Courier New', 'SF Mono', 'Monaco', 'Lucida Console', 'Menlo', monospace;
  
  /* Font Sizes (default base: 11px - these will be overridden by JS) */
  --text-xs: 9px;    /* 11 * 0.786 */
  --text-sm: 10px;   /* 11 * 0.857 */
  --text-base: 11px;
  --text-lg: 13px;   /* 11 * 1.143 */
  --text-xl: 16px;   /* 11 * 1.429 */
  --text-2xl: 19px;  /* 11 * 1.714 */
  
  /* Line Heights (default 1.25 - these will be overridden by JS) */
  --leading-tight: 0.95;  /* 1.25 - 0.3 */
  --leading-normal: 1.25;
  --leading-relaxed: 1.5; /* 1.25 + 0.25 */
  
  /* Font Weights */
  --font-normal: 400;
  --font-medium: 500;
  --font-semibold: 600;
  --font-bold: 700;
  
  /* Spacing */
  --space-1: 4px;
  --space-2: 8px;
  --space-3: 12px;
  --space-4: 16px;
  --space-5: 20px;
  --space-6: 24px;
  --space-8: 32px;
  --space-10: 40px;
  --space-12: 48px;
  --space-16: 64px;
  
  /* Border Radius */
  --radius-sm: 4px;
  --radius-md: 6px;
  --radius-lg: 8px;
  --radius-xl: 12px;
  --radius-full: 9999px;
  
  /* Layout */
  --sidebar-width: 48px;
  --sidebar-expanded-width: 200px;
  --sidepanel-width: 300px;
  --titlebar-height: 52px;
  --statusbar-height: 28px;
  
  /* Transitions - optimized for snappy feel */
  --transition-fast: 100ms cubic-bezier(0.4, 0, 0.2, 1);
  --transition-base: 150ms cubic-bezier(0.4, 0, 0.2, 1);
  --transition-slow: 200ms cubic-bezier(0.4, 0, 0.2, 1);
}

/* Reset */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  /* App-like: disable text selection by default, enable only where needed */
  user-select: none;
  -webkit-user-select: none;
  cursor: default;
}

/* PERFORMANCE: Faster touch response on all interactive elements */
button, a, input, textarea, [role="button"] {
  touch-action: manipulation;
}

/* Allow text selection and text cursor where it makes sense */
input, textarea {
  user-select: text;
  -webkit-user-select: text;
  cursor: text;
}

/* Selectable text utility class - use for message content, code, etc */
.selectable,
.selectable * {
  user-select: text !important;
  -webkit-user-select: text !important;
  cursor: text !important;
}

html,
body,
#root {
  width: 100%;
  height: 100%;
  overflow: hidden;
  /* CRITICAL: Force transparency for WebView2 window transparency on Windows */
  background: transparent !important;
  /* PERFORMANCE: Optimize text rendering */
  text-rendering: optimizeSpeed;
  -webkit-font-smoothing: antialiased;
}

body {
  font-family: var(--font-sans);
  font-size: var(--text-base);
  line-height: var(--leading-normal);
  color: var(--color-text-primary);
  /* Use --bg-color for transparency support - set by index.html
     On Windows: transparent (WebView2 only supports alpha=0 or alpha=255)
     On macOS/Linux: semi-transparent via native support */
  background: var(--bg-color, transparent);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  border-radius: 4px;
  overflow: hidden;
  position: relative;
  /* Create stacking context so ::before with z-index:-1 stays within body */
  isolation: isolate;
}

/* Windows transparency overlay - provides the tinted background effect
   WebView2 only supports fully transparent or fully opaque backgrounds,
   so we use a pseudo-element overlay to simulate semi-transparency.
   The isolation: isolate on body ensures this stays within the body's
   stacking context and doesn't go behind the window itself. */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  /* --bg-overlay-color is set by index.html based on platform:
     Windows: rgba(0,0,0,alpha) for tint effect
     macOS/Linux: transparent (native semi-transparency handles it) */
  background: var(--bg-overlay-color, transparent);
  pointer-events: none;
  z-index: -1;
  border-radius: 4px;
}

/* App Layout */
.app {
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%;
  /* Transparent to allow window transparency to show through */
  background: transparent;
  padding-top: 0;
}

/* Windows: Keep space for custom titlebar in frameless window */
.platform-win32 .app-body {
  height: calc(100vh - var(--titlebar-height));
}

.app-body {
  flex: 1;
  display: flex;
  overflow: hidden;
}

.main-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  /* Transparent to allow window transparency to show through */
  background: transparent;
}

.chat-container {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

/* Scrollbar Styles - 3px minimal with 50% opacity */
/* Firefox scrollbar - thin style */
* {
  scrollbar-width: thin;
  scrollbar-color: rgba(var(--foreground-rgb), 0.5) rgba(var(--foreground-rgb), 0.05);
}

::-webkit-scrollbar {
  width: 3px;
  height: 3px;
}

::-webkit-scrollbar-track {
  background: rgba(var(--foreground-rgb), 0.05);
}

::-webkit-scrollbar-thumb {
  background: rgba(var(--foreground-rgb), 0.5);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(var(--foreground-rgb), 0.7);
}

::-webkit-scrollbar-corner {
  background: transparent;
}

/* Ensure ALL scrollbars in chat-container use 3px minimal style */
.chat-container::-webkit-scrollbar,
.chat-container *::-webkit-scrollbar,
.virtualized-messages-container::-webkit-scrollbar,
.virtualized-messages-container *::-webkit-scrollbar,
.messages-virtualized::-webkit-scrollbar,
.messages-virtualized *::-webkit-scrollbar,
[class*="virtualized"]::-webkit-scrollbar,
[class*="virtualized"] *::-webkit-scrollbar {
  width: 3px !important;
  height: 3px !important;
}

.chat-container::-webkit-scrollbar-track,
.chat-container *::-webkit-scrollbar-track,
.virtualized-messages-container::-webkit-scrollbar-track,
.virtualized-messages-container *::-webkit-scrollbar-track,
.messages-virtualized::-webkit-scrollbar-track,
.messages-virtualized *::-webkit-scrollbar-track,
[class*="virtualized"]::-webkit-scrollbar-track,
[class*="virtualized"] *::-webkit-scrollbar-track {
  background: rgba(var(--foreground-rgb), 0.05) !important;
}

.chat-container::-webkit-scrollbar-thumb,
.chat-container *::-webkit-scrollbar-thumb,
.virtualized-messages-container::-webkit-scrollbar-thumb,
.virtualized-messages-container *::-webkit-scrollbar-thumb,
.messages-virtualized::-webkit-scrollbar-thumb,
.messages-virtualized *::-webkit-scrollbar-thumb,
[class*="virtualized"]::-webkit-scrollbar-thumb,
[class*="virtualized"] *::-webkit-scrollbar-thumb {
  background: rgba(var(--foreground-rgb), 0.5) !important;
  border-radius: 4px !important;
}

.chat-container::-webkit-scrollbar-thumb:hover,
.chat-container *::-webkit-scrollbar-thumb:hover,
.virtualized-messages-container::-webkit-scrollbar-thumb:hover,
.virtualized-messages-container *::-webkit-scrollbar-thumb:hover,
.messages-virtualized::-webkit-scrollbar-thumb:hover,
.messages-virtualized *::-webkit-scrollbar-thumb:hover,
[class*="virtualized"]::-webkit-scrollbar-thumb:hover,
[class*="virtualized"] *::-webkit-scrollbar-thumb:hover {
  background: rgba(var(--foreground-rgb), 0.7) !important;
}

/* Selection */
::selection {
  background: rgba(var(--accent-rgb), 0.25);
  color: var(--color-text-primary);
}

::-moz-selection {
  background: rgba(var(--accent-rgb), 0.25);
  color: var(--color-text-primary);
}

/* Focus Styles */
:focus {
  outline: none;
}

:focus-visible {
  outline: 1px solid var(--accent-color);
  outline-offset: 0;
}

/* Button Base Styles */
button {
  font-family: inherit;
  font-size: inherit;
  color: inherit;
  background: none;
  border: none;
  cursor: default;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

button:disabled {
  opacity: 0.5;
  cursor: default;
}

/* Input Base Styles */
input,
textarea {
  font-family: inherit;
  font-size: inherit;
  color: inherit;
  background: var(--background-color);
  border: 1px solid rgba(var(--accent-rgb), 0.5);
  border-radius: var(--radius-sm);
  padding: var(--space-2) var(--space-3);
}

input:focus,
textarea:focus {
  outline: none;
}

/* Link Styles */
a {
  color: var(--color-accent-blue);
  text-decoration: none;
}

a:hover {
  color: var(--color-accent-purple);
}

/* Code Styles */
code {
  font-family: var(--font-mono);
  font-size: 0.9em;
  background: var(--background-color);
  padding: 0;
  border-radius: var(--radius-sm);
  color: var(--code-color);
}

pre {
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  line-height: normal;
  background: var(--background-color);
  padding: 0;
  border-radius: 2px !important;
  overflow-x: auto;
  color: var(--code-color);
}

/* Utility Classes */
.truncate {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.flex {
  display: flex;
}

.flex-col {
  flex-direction: column;
}

.items-center {
  align-items: center;
}

.justify-center {
  justify-content: center;
}

.justify-between {
  justify-content: space-between;
}

.gap-1 { gap: var(--space-1); }
.gap-2 { gap: var(--space-2); }
.gap-3 { gap: var(--space-3); }
.gap-4 { gap: var(--space-4); }

.p-1 { padding: var(--space-1); }
.p-2 { padding: var(--space-2); }
.p-3 { padding: var(--space-3); }
.p-4 { padding: var(--space-4); }

.px-2 { padding-left: var(--space-2); padding-right: var(--space-2); }
.px-3 { padding-left: var(--space-3); padding-right: var(--space-3); }
.px-4 { padding-left: var(--space-4); padding-right: var(--space-4); }

.py-2 { padding-top: var(--space-2); padding-bottom: var(--space-2); }
.py-3 { padding-top: var(--space-3); padding-bottom: var(--space-3); }
.py-4 { padding-top: var(--space-4); padding-bottom: var(--space-4); }

/* Animations */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideIn {
  from { transform: translateY(10px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.8; }
}

@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

.animate-fadeIn {
  animation: fadeIn var(--transition-base);
}

.animate-slideIn {
  animation: slideIn var(--transition-base);
}

.animate-pulse {
  animation: pulse 2s infinite;
}

.animate-spin {
  animation: spin 1s linear infinite;
}

/* Ensure tool icons have full opacity - tabler icons */
.tool-icon {
  opacity: 1 !important;
}

.tool-icon svg {
  opacity: 1 !important;
}

.tool-use svg {
  opacity: 1 !important;
}

svg {
  width: var(--text-sm) !important;
  height: var(--text-sm) !important;
  vertical-align: middle;
}

#debug {
  display: none !important;
}

/* Icon Opacity Wrapper
   Use .icon-opacity-* classes to apply opacity to icons without causing
   overlapping stroke transparency issues. The icon inherits solid color
   from parent, and opacity is applied to the wrapper container.

   Usage: <span class="icon-opacity-50"><IconSettings /></span>
*/
.icon-opacity-10 { opacity: 0.1; display: inline-flex; align-items: center; justify-content: center; }
.icon-opacity-20 { opacity: 0.2; display: inline-flex; align-items: center; justify-content: center; }
.icon-opacity-30 { opacity: 0.3; display: inline-flex; align-items: center; justify-content: center; }
.icon-opacity-40 { opacity: 0.4; display: inline-flex; align-items: center; justify-content: center; }
.icon-opacity-50 { opacity: 0.5; display: inline-flex; align-items: center; justify-content: center; }
.icon-opacity-60 { opacity: 0.6; display: inline-flex; align-items: center; justify-content: center; }
.icon-opacity-70 { opacity: 0.7; display: inline-flex; align-items: center; justify-content: center; }
.icon-opacity-80 { opacity: 0.8; display: inline-flex; align-items: center; justify-content: center; }
.icon-opacity-90 { opacity: 0.9; display: inline-flex; align-items: center; justify-content: center; }

/* Fix for tabler icon stroke overlap with transparent colors.
   When using rgba colors on icons, the overlapping strokes show through.
   This adds a small background blur that masks the overlap effect.
   Only applies when color has transparency (detected via paint-order trick).
*/
.tabler-icon {
  /* Ensure strokes don't show overlap artifacts */
  stroke-linejoin: round;
  stroke-linecap: round;
}

/* PERFORMANCE: Respect user preference for reduced motion */
/* DISABLED - breaks LoadingIndicator on Windows
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}
*/
