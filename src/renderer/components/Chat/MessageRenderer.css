/* Message Renderer - Complete Event Display */

.message {
  position: relative;
  margin-bottom: 1px;
  /* animation removed - conflicts with virtualizer transform positioning */
  max-width: 100%;
  box-sizing: border-box;
  overflow-x: hidden;
  word-wrap: break-word;
  overflow-wrap: break-word;
}

/* System error messages */
.message.system-error {
  margin: 12px 0;
}

.message.system-error .message-content {
  background: transparent;
  border: 1px solid rgba(255, 153, 153, 0.2);
  padding: 0;
  max-width: 100%;
}

.error-message {
  color: var(--color-magenta);
  padding: 4px;
  background: transparent;
  font-size: var(--text-sm);
  display: flex;
  align-items: center;
  gap: 6px;
  font-family: var(--font-mono);
}

/* Interrupted message */
.message.system-interrupted {
  margin: 0;
  padding: 0;
  opacity: 0.8;
}

.message.system-interrupted .message-content {
  background: transparent;
  border: none;
  padding: 0;
  margin: 0;
}

.interrupted-message {
  color: var(--negative-color);
  padding: 0;
  margin: 0;
  background: transparent;
  font-size: var(--text-sm);
  display: flex;
  align-items: center;
  gap: 4px;
  font-family: var(--font-mono);
  text-transform: lowercase;
}

/* Message hover actions */
.message-actions {
  display: flex;
  flex-direction: column;
  gap: 2px;
  opacity: 0;
  margin-left: 2px;
  align-self: flex-end;
  justify-content: flex-end;
}

/* User message actions on the left */
.message-actions.user-actions {
  margin-left: 0;
  margin-right: 2px;
  order: -1;
}

@keyframes fadeIn {
  to {
    opacity: 1;
  }
}

.action-btn {
  padding: 0;
  background: rgba(var(--foreground-rgb), 0.03);
  border: none;
  border-radius: 4px;
  color: rgba(var(--foreground-rgb), 0.5);
  cursor: default;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 16px;
  height: 15.5px;
}

.action-btn:hover {
  background: rgba(var(--foreground-rgb), 0.08);
  color: var(--accent-color);
}

.message:hover .message-actions {
  opacity: 1;
}

/* System Init */
.message.system-init {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 6px 0;
  color: rgba(var(--foreground-rgb), 0.6);
  font-size: var(--text-base);
}

.init-icon {
  color: rgba(255, 230, 153, 0.7);
  animation: pulse 1s ease;
  vertical-align: middle;
}

.init-text {
  font-weight: normal;
  color: rgba(var(--foreground-rgb), 0.6);
}

.init-folder {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 2px 8px;
  background: rgba(var(--foreground-rgb), 0.08);
  border: none;
  border-radius: 12px;
  margin-left: 0;
}

.folder-icon {
  color: rgba(255, 230, 153, 0.7);
  vertical-align: middle;
}

.folder-name {
  color: var(--accent-color);
  font-weight: 500;
}

.init-path {
  font-family: var(--font-mono);
  color: var(--fg-40);
  opacity: 0.5;
  font-size: var(--text-sm);
  margin-left: 4px;
}

/* User Messages */
.message.user {
  margin-bottom: 4px;
  display: flex;
  flex-direction: row;
  justify-content: flex-end;
  align-items: flex-end;
}

.message.user .message-bubble {
  background: rgba(var(--accent-rgb), 0.15);
  border: none;
  color: var(--fg-100);
  padding: 8px 12px;
  border-radius: 12px 12px 4px 12px;
  min-width: 60px;
  font-size: var(--text-base);
  line-height: var(--leading-normal);
  max-width: 100%;
  width: auto;
  word-wrap: break-word;
  overflow-wrap: break-word;
  display: inline-block;
}

.message.user .message-bubble.font-mono {
  font-family: var(--font-mono);
}

.message.user .message-bubble.bash-mode {
  background: rgba(var(--negative-rgb), 0.15);
  color: rgba(var(--foreground-rgb), 0.9);
  font-size: var(--text-sm);
}

.message.user .message-bubble.command-mode {
  background: rgba(var(--positive-rgb), 0.15);
  color: rgba(var(--foreground-rgb), 0.9);
}

.message.assistant .message-bubble {
  background: var(--bg-brighter-alpha);
  border: none;
  color: var(--fg-100);
  padding: 8px 12px;
  border-radius: 12px 12px 12px 4px;
  min-width: 60px;
  max-width: 100%;
  font-size: var(--text-base);
  line-height: var(--leading-normal);
  box-shadow: none;
  width: auto;
  display: inline-block;
  word-wrap: break-word;
  overflow-wrap: break-word;
  box-sizing: border-box;
}

/* Assistant Messages */
.message.assistant {
  margin-bottom: 4px;
  display: flex;
  flex-direction: row;
  align-items: flex-end;
  justify-content: flex-start;
}

.message.assistant .message-content {
  width: auto;
  padding-left: 0;
  display: inline-block;
  flex: unset;
}

/* Assistant message text elements use code color for code/pre */
.message.assistant .message-bubble code,
.message.assistant .message-bubble pre {
  color: var(--code-color);
}

/* Bash/ANSI/shell output in assistant messages uses mix of foreground and negative */
.message.assistant .message-bubble code.language-ansi,
.message.assistant .message-bubble pre:has(code.language-ansi),
.message.assistant .message-bubble code.language-bash,
.message.assistant .message-bubble pre:has(code.language-bash),
.message.assistant .message-bubble code.language-sh,
.message.assistant .message-bubble pre:has(code.language-sh),
.message.assistant .message-bubble code.language-shell,
.message.assistant .message-bubble pre:has(code.language-shell),
.message.assistant .message-bubble code.language-zsh,
.message.assistant .message-bubble pre:has(code.language-zsh) {
  color: color-mix(in srgb, var(--foreground-color) 80%, var(--negative-color) 20%);
}

/* Assistant response to bash command - uses negative-mix styling */
.message.assistant .message-bubble.bash-response,
.message.assistant .message-bubble.bash-response .content-text,
.message.assistant .message-bubble.bash-response .content-text pre,
.message.assistant .message-bubble.bash-response .content-text code,
.message.assistant .message-bubble.bash-response .markdown-content,
.message.assistant .message-bubble.bash-response .markdown-content pre,
.message.assistant .message-bubble.bash-response .markdown-content code,
.message.assistant .message-bubble.bash-response .bash-output-content {
  color: color-mix(in srgb, var(--foreground-color) 80%, var(--negative-color) 20%);
  font-family: var(--font-mono);
}

/* Bash output pre styling */
.message.assistant .message-bubble.bash-response .bash-output-content {
  margin: 0;
  padding: 0;
  white-space: pre-wrap;
  word-break: break-word;
  background: transparent;
}

/* Bash elapsed time indicator */
.bash-elapsed-time {
  font-size: 10px;
  opacity: 0.5;
  margin-top: 4px;
  font-family: var(--font-mono);
}

.message.user .message-content {
  max-width: 80%;
  width: auto;
  padding-left: 0;
  display: inline-block;
}

.message-content {
  max-width: 100%;
  width: 100%;
  padding-left: 0;
  display: block;
  box-sizing: border-box;
  overflow-x: visible;
  word-wrap: break-word;
  overflow-wrap: break-word;
}

/* Markdown Content */
.content-text,
.markdown-content {
  color: var(--fg-100);
  font-size: var(--text-base);
  line-height: var(--leading-normal);
  padding-left: 0;
  max-width: 100%;
  box-sizing: border-box;
  word-wrap: break-word;
  overflow-wrap: break-word;
  word-break: break-word;
}

.content-text p,
.markdown-content p {
  margin: 0 0 2px 0;
}

p {
  line-height: var(--leading-relaxed);
}

.content-text p:last-child,
.markdown-content p:last-child {
  margin-bottom: 0;
}

.markdown-content code {
  background: rgba(0, 0, 0, 0.15);
  color: var(--code-color);
  padding: 0;
  border-radius: 4px;
  font-size: var(--text-sm);
  font-family: var(--font-mono);
  max-width: 100%;
  display: inline-block;
  overflow-x: auto;
  overflow-wrap: normal;
  word-break: normal;
  scrollbar-width: thin;
  vertical-align: text-bottom;
  line-height: 1;
}

.markdown-content pre {
  background: var(--background-color);
  border: none !important;
  border-radius: 2px !important;
  padding: 2px;
  margin: 0;
  overflow-x: auto;
  white-space: pre;
  word-break: normal;
  overflow-wrap: normal;
  max-width: 100%;
  box-sizing: border-box;
  scrollbar-width: thin;
}

.markdown-content pre code {
  background: none;
  color: var(--code-color);
  padding: 0;
  max-width: 100%;
  display: block;
  overflow-x: auto;
  font-size: var(--text-sm);
  scrollbar-width: thin;
}

/* Code block with copy button */
.code-block-wrapper {
  margin: 0;
  padding: 0;
  border: none !important;
  border-radius: 2px;
  overflow-x: auto;
  overflow-y: visible;
  background: transparent;
  max-width: 100%;
  box-sizing: border-box;
  scrollbar-width: thin;
}

.code-block-pre {
  margin: 0;
  padding: 8px;
  background: #0f0f0f;
  border-radius: 2px;
  overflow-x: auto;
  scrollbar-width: thin;
}

.code-block-pre code {
  font-family: var(--font-mono);
  font-size: var(--text-base);
  color: #dcdcdc;
  white-space: pre;
  display: block;
}

.code-block-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: transparent;
  padding: 2px;
  border: none !important;
}

.code-language {
  color: var(--fg-50);
  font-size: var(--text-sm);
  font-family: var(--font-mono);
  text-transform: lowercase;
  padding-left: 2px;
}

.code-copy-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: none;
  color: rgba(var(--foreground-rgb), 0.4);
  padding: 2px;
  border-radius: 4px;
  font-size: var(--text-base);
  cursor: default;
}

.code-copy-btn:hover {
  background: rgba(var(--foreground-rgb), 0.1);
  color: var(--fg-100);
}

.code-copy-btn:active {
  transform: scale(0.95);
}

.markdown-content h1 {
  color: var(--color-magenta);
  margin: 0;
  padding: 0;
  font-weight: 500;
}

.markdown-content h2 {
  color: var(--accent-color);
  margin: 0;
  padding: 0;
  font-weight: 500;
}

.markdown-content h3 {
  color: var(--fg-90);
  margin: 0;
  padding: 0;
  font-weight: 500;
}

.markdown-content ul,
.markdown-content ol {
  margin-bottom: 3px;
  padding-left: 12px;
  list-style-position: outside;
}

/* Ensure all ol elements have proper margin */
ol {
  margin-left: 12px;
  padding-left: 12px;
}

.markdown-content li {
  margin-bottom: 3px;
  padding-left: 4px;
}

/* Nested lists */
.markdown-content ul ul,
.markdown-content ul ol,
.markdown-content ol ul,
.markdown-content ol ol {
  margin: 0;
  padding-left: 12px;
}

/* Style list markers */
.markdown-content ul {
  list-style-type: disc;
}

.markdown-content ul ul {
  list-style-type: circle;
}

.markdown-content ul ul ul {
  list-style-type: square;
}

.markdown-content ol {
  list-style-type: decimal;
}

.markdown-content ol ol {
  list-style-type: lower-alpha;
}

.markdown-content a {
  color: var(--accent-color);
  text-decoration: none;
  border-bottom: 1px dotted transparent;
}

.markdown-content a:hover {
  border-bottom-color: var(--accent-color);
}

/* Thinking indicator */
.thinking-indicator {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 8px 12px;
  color: var(--accent-color);
  font-size: var(--text-base);
  animation: fadeIn 0.3s ease;
  font-weight: bold;
}

.thinking-indicator.inline {
  display: inline-flex;
  padding: 0;
  margin-left: 0;
  vertical-align: middle;
}

/* Thinking indicator outside bubble */
.thinking-indicator-outside {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 12px;
  margin-top: 8px;
  color: var(--accent-color);
  font-size: var(--text-base);
  font-style: italic;
  font-weight: bold;
}

.thinking-text {
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  line-height: 1.4;
  white-space: pre-wrap;
  word-break: break-word;
  margin: 0;
  padding: 0;
  color: rgba(var(--foreground-rgb), 0.55);
  font-style: italic;
  letter-spacing: 0.2px;
}

/* Original thinking text for headers and labels */
.thinking-label {
  opacity: 1;
  color: var(--accent-color);
  font-weight: bold;
  display: inline-block;
  min-width: 60px; /* Fixed width to prevent layout shift */
}

.thinking-dots::after {
  content: '...';
  display: inline-block;
  animation: dots 1.4s steps(4, end) infinite;
  width: 1.5em;
  text-align: left;
}

/* Thinking message container */
.message.thinking-message {
  margin: 8px 0;
  padding: 0;
}

/* Simple thinking block - always fully visible */
.thinking-block {
  font-size: var(--text-base);
  color: rgba(var(--foreground-rgb), 0.95);
}

.thinking-block.streaming {
}

.thinking-header {
  display: flex;
  align-items: center;
  gap: 8px;
  color: var(--color-magenta);
  font-size: var(--text-base);
  text-transform: lowercase;
  opacity: 0.9;
}

.thinking-icon {
  color: var(--color-magenta);
}

.thinking-label {
  font-weight: 600;
  color: var(--color-magenta);
  letter-spacing: 0.5px;
}

.thinking-stats {
  font-size: var(--text-xs);
  color: rgba(var(--foreground-rgb), 0.4);
  margin-left: auto;
}

/* Accent text for thinking blocks */
.accent-text {
  color: var(--accent-color) !important;
}

.thinking-text {
  font-family: var(--font-sans);
  font-size: var(--text-sm);
  line-height: 1.2;
  white-space: pre-wrap;
  word-break: break-word;
  margin: 0;
  padding: 0;
  color: rgba(var(--foreground-rgb), 0.8);
}

.thinking-content {
  /* no max-height - show all thinking content */
  overflow-x: hidden;
  overflow-y: visible;
  max-width: 100%;
  box-sizing: border-box;
  word-wrap: break-word;
  overflow-wrap: break-word;
}

/* Markdown styling for thinking blocks */
.thinking-markdown {
  font-family: var(--font-sans);
  font-size: var(--text-sm);
line-height: var(--leading-normal);
  margin-right: 8px;
  color: rgba(var(--foreground-rgb), 0.8);
}

.thinking-markdown p {
  margin: 0 0 4px 0;
}

.thinking-markdown p:last-child {
  margin-bottom: 0;
}

.content-text ul,
.content-text ol,
.thinking-markdown ul,
.thinking-markdown ol {
  margin-left: 10px;
  margin-bottom: 2px;
}

.content-text li,
.thinking-markdown li {
  margin-bottom: 2px;
}

.thinking-markdown strong {
  font-weight: 600;
  color: rgba(var(--foreground-rgb), 0.85);
}

.thinking-markdown em {
  font-style: italic;
}

.thinking-markdown h1,
.thinking-markdown h2,
.thinking-markdown h3,
.thinking-markdown h4,
.thinking-markdown h5,
.thinking-markdown h6 {
  margin: 12px 0 6px 0;
  font-weight: 600;
  color: rgba(var(--foreground-rgb), 0.85);
}

.thinking-markdown h1 { font-size: var(--text-lg); }
.thinking-markdown h2 { font-size: var(--text-lg); }
.thinking-markdown h3 { font-size: var(--text-base); }
.thinking-markdown h4,
.thinking-markdown h5,
.thinking-markdown h6 { font-size: var(--text-base); }

.thinking-markdown blockquote {
  margin: 8px 0;
  padding: 4px 12px;
  border-left: 2px solid rgba(var(--accent-rgb), 0.4);
  color: rgba(var(--foreground-rgb), 0.6);
  font-style: italic;
}

.thinking-markdown hr {
  border: none;
  border-top: 1px solid rgba(var(--foreground-rgb), 0.1);
  margin: 12px 0;
}

.thinking-markdown pre {
  background: var(--background-color, #000000);
  border-radius: 2px;
  padding: 8px;
  margin: 8px 0;
  margin-right: 2px;
  overflow-x: auto;
  scrollbar-width: thin;
  line-height: 1.2;
}

.thinking-markdown pre code {
  background: none;
  padding: 0;
  line-height: 1.2;
}

/* Thinking block code formatting (legacy - keep for compatibility) */
.thinking-text-container {
  font-family: var(--font-sans);
  font-size: var(--text-sm);
  line-height: 1.5;
  color: rgba(var(--foreground-rgb), 0.8);
  white-space: pre-wrap;
  word-break: break-word;
}

/* Inline code in thinking blocks */
.thinking-inline-code {
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  padding: 1px 4px;
  color: var(--code-color);
}

/* Code blocks in thinking blocks */
.thinking-code-block {
  margin: 8px 0;
  background: rgba(0, 0, 0, 0.1);
  border-radius: 4px;
  margin-right: 2px;
  overflow: hidden;
}

.thinking-code-lang {
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  color: rgba(var(--foreground-rgb), 0.4);
  background: rgba(0, 0, 0, 0.08);
  text-transform: lowercase;
}

.thinking-code-pre {
  margin: 0;
  padding: 4px;
  margin-right: 2px;
  overflow-x: auto;
  max-width: 100%;
  color: var(--code-color);
  box-sizing: border-box;
  scrollbar-width: thin;
  line-height: 1.2;
}

.thinking-code {
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  line-height: 1.2;
  color: var(--foreground-color);
  white-space: pre;
}


/* Remove old animations that are no longer used */
@keyframes thinkingPulse {
  0%, 100% {
    opacity: 0.9;
  }
  50% {
    opacity: 1;
  }
}

@keyframes letterWave {
  0%, 100% {
    opacity: 0.9;
    transform: translateY(0);
  }
  25% {
    opacity: 1;
    transform: translateY(-1px);
  }
  50% {
    opacity: 0.95;
    transform: translateY(0);
  }
  75% {
    opacity: 1;
    transform: translateY(-0.5px);
  }
}


@keyframes dots {
  0%, 20% {
    content: '.';
  }
  40% {
    content: '..';
  }
  60%, 100% {
    content: '...';
  }
}

/* Tool Use Display */
.tool-use {
  display: inline-flex;
  align-items: center;
  gap: 3px;
  padding: 0 !important;
  background: transparent !important;
  border: none;
  border-radius: 16px;
  font-size: var(--text-base);
  margin: 4px 4px 4px 0;
  /* animation removed - transform conflicts with virtualizer */
}

/* Standalone tool messages */
.tool-message, .tool-result-message {
  padding: 0;
  margin: 0;
  line-height: 1;
  margin-bottom: 4px !important;
}

.tool-use.standalone {
  display: flex;
  flex-wrap: wrap;
  gap: 0 4px;
  line-height: var(--leading-relaxed);
  width: 100%;
  background: transparent !important;
  border: none;
  padding: 0 !important;
  padding-bottom: 0 !important;
  margin-bottom: 0 !important;
  margin-top: 0 !important;
}

.tool-use.subagent-tool {
  display: flex;
  flex-wrap: wrap;
  align-items: baseline;
  gap: 0 4px;
}

.subagent-indicator {
  color: var(--accent-color) !important;
  opacity: .8;
  font-size: var(--text-sm);
  margin-right: 2px;
}

@keyframes subagentSlide {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 0.75;
    transform: translateX(0);
  }
}

.tool-result.standalone {
  background: transparent;
  border: none;
  border-radius: 0;
  padding: 0;
  margin-top: 0;
  margin-bottom: 0;
  line-height: 1;
}

.tool-result.standalone .result-content {
  margin: 0 0 2px 0;
  padding: 0;
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  color: rgba(var(--foreground-rgb), 0.8);
  white-space: pre;
  max-height: 400px;
  overflow-x: auto;
  overflow-y: auto;
  scrollbar-width: thin;
}

/* Write tool output */
.tool-result.standalone.write-output .result-content {
  font-size: var(--text-xs);
}

.tool-result.standalone.file-diff .result-content {
  background: transparent;
  border-left: none;
  padding-left: 0;
}

/* Edit result diff display - MINIMAL */
.tool-result.file-edit {
  display: block;
  background: transparent;
  border: none;
  padding: 0;
  margin: 0;
}

.diff-header {
  display: flex;
  align-items: center;
  gap: 6px;
}

.diff-icon {
  color: rgba(255, 153, 153, 0.7);
  flex-shrink: 0;
}

.diff-file-path {
  color: rgba(var(--foreground-rgb), 0.7);
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  line-height: 1.4;
  font-weight: 400;
}

.diff-content {
  display: block;
  margin: 0;
  padding: 0;
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  background: transparent;
  overflow-x: auto;
  white-space: pre;
  scrollbar-width: thin;
}

.diff-line {
  display: flex;
  line-height: 16px;
  flex-wrap: nowrap;
  word-break: break-all;
}

.diff-line .line-number {
  display: inline-block;
  min-width: 20px;
  color: rgba(var(--foreground-rgb), 0.3);
  text-align: right;
  flex-shrink: 0;
  font-size: var(--text-sm);
}

.diff-line .line-content {
  flex: 1;
  white-space: pre;
  color: rgba(var(--foreground-rgb), 1);
}

/* Visible colors for removed/added */
.diff-line.added {
  background: rgba(var(--positive-rgb), 0.18);
}

.diff-line.added .line-content {
  color: var(--positive-color);
}

.diff-line.removed {
  background: rgba(var(--negative-rgb), 0.18);
}

.diff-line.removed .line-content {
  color: var(--negative-color);
}

.diff-summary {
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  color: rgba(var(--foreground-rgb), 0.5);
  margin: 2px 0;
  padding-left: 20px;
}

/* Edit tool use diff display */
.tool-use-edit {
  display: inline-flex;
  flex-wrap: wrap;
  align-items: baseline;
  gap: 0 6px;
  margin: 0;
  padding: 0;
}

.tool-use-edit.standalone {
  display: flex;
  flex-wrap: wrap;
  align-items: baseline;
  gap: 0 6px;
  width: 100%;
}

.edit-header {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 0;
  color: var(--fg-40);
  font-size: var(--text-sm);
}

/* Edit fallback display - matches DiffViewer font size */
.edit-content {
  display: block;
  margin: 0;
  padding: 0;
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  line-height: 16px;
  background: transparent;
  overflow-x: auto;
  white-space: pre;
}

.edit-line {
  display: flex;
  line-height: 16px;
  flex-wrap: nowrap;
}

.edit-line .line-number {
  color: rgba(var(--foreground-rgb), 0.3);
  padding-right: 8px;
  user-select: none;
  font-size: var(--text-xs);
}

.edit-line .line-marker {
  color: rgba(var(--foreground-rgb), 0.4);
  padding-right: 4px;
  user-select: none;
}

.edit-line .line-text {
  color: rgba(var(--foreground-rgb), 0.8);
}

.edit-line.changed .line-text {
  color: rgba(102, 204, 102, 0.9);
}

.edit-line.changed .line-marker {
  color: rgba(102, 204, 102, 0.7);
}

/* Edit output fallback */
.tool-result.edit-output .result-content {
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  line-height: 16px;
}

.edit-action {
  color: var(--accent-color);
  font-weight: 500;
  font-size: var(--text-sm);
  margin-right: 8px;
}

.edit-file {
  color: rgba(var(--foreground-rgb), 0.9);
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  display: block;
  margin-top: 4px;
}

.edit-diff {
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  margin: 0;
  margin-bottom: 2px;
  padding: 0;
}

.edit-diff pre,
pre.edit-diff {
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  margin: 0;
  padding: 4px 8px;
  white-space: pre;
  color: var(--fg-60);
  background: transparent;
  border: none;
  overflow-x: auto;
  max-width: 100%;
  box-sizing: border-box;
  scrollbar-width: thin;
}

.diff-section {
  margin: 0;
  padding: 0;
}

.diff-section.removed {
  margin-bottom: 2px;
}

.edit-diff .diff-line {
  display: flex;
  line-height: 1.4;
  padding: 0;
  margin: 0;
}

.diff-line .line-number {
  width: 25px;
  flex-shrink: 0;
  text-align: right;
  color: rgba(var(--foreground-rgb), 0.3);
  font-size: var(--text-sm);
  font-family: var(--font-mono);
}

.diff-marker {
  width: 16px;
  flex-shrink: 0;
  text-align: center;
  font-weight: bold;
}

.diff-text {
  flex: 1;
  white-space: pre;
}

.diff-line.removed .diff-marker,
.diff-line.removed .diff-text {
  color: var(--negative-color) !important;
}

.diff-line.added .diff-marker,
.diff-line.added .diff-text {
  color: var(--positive-color) !important;
}

.diff-line.context .diff-marker,
.diff-line.context .diff-text {
  color: rgba(var(--foreground-rgb), 0.4);
}

.diff-line.context .line-number {
  color: rgba(var(--foreground-rgb), 0.1);
}

/* Edit tool diff colors */
.edit-diff .diff-line.removed .diff-marker,
.edit-diff .diff-line.removed .diff-text {
  color: var(--negative-color) !important;
}

.edit-diff .diff-line.added .diff-marker,
.edit-diff .diff-line.added .diff-text {
  color: var(--positive-color) !important;
}

/* Enhanced diff with context lines */
.edit-diff .diff-line-changed {
  color: var(--color-cyan);
  display: block;
  font-weight: bold;
}

.edit-diff .diff-line-context {
  color: rgba(var(--foreground-rgb), 0.4);
  display: block;
}

.edit-diff .diff-line-separator {
  color: rgba(var(--foreground-rgb), 0.3);
  display: block;
  text-align: center;
  margin: 2px 0;
}

.diff-separator {
  color: rgba(var(--foreground-rgb), 0.5);
  font-size: var(--text-sm);
  font-family: var(--font-mono);
  margin: 8px 0 4px 0;
  padding: 2px 0;
  border-top: 1px solid rgba(var(--foreground-rgb), 0.1);
  text-transform: lowercase;
  opacity: 0.7;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes toolSlide {
  from {
    opacity: 0;
    transform: translateX(-10px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

/* Hover effect removed for cleaner look */

.tool-icon {
  display: inline-flex;
  align-items: center;
  margin-right: 0px;
  color: var(--accent-color);
  flex-shrink: 0;
  /* animation removed - transform conflicts with virtualizer */
}

@keyframes iconBounce {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

.tool-action {
  color: var(--accent-color);
  font-weight: 500;
  font-size: var(--text-sm);
}

.tool-detail {
  color: var(--fg-60);
  font-family: var(--font-mono);
  opacity: 1;
  max-width: 100%;
  overflow-x: visible;
  overflow-y: visible;
  white-space: pre-wrap;
  word-break: break-word;
  box-sizing: border-box;
  scrollbar-width: thin;
}

/* Windows-specific adjustment for tool-detail positioning */
body.platform-win32 .tool-detail {
  position: relative;
  top: 0px;
}

/* Line info display for edit results */
.tool-line-info {
  color: rgba(var(--foreground-rgb), 0.4);
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  margin-left: 6px;
  opacity: 0.8;
}

/* Tool Results */
.tool-result {
  display: inline-flex;
  flex-wrap: wrap;
  align-items: baseline;
  gap: 0 6px;
  padding: 0;
  border-radius: 0;
  font-size: var(--text-xs);
  margin: 0;
  /* animation removed - conflicts with virtualizer */
}

/* Result completion time */
.message.result-success {
  margin: 0 !important;
  padding: 0 !important;
  border: none !important;
  display: flex !important;
  flex-direction: column !important;
  min-height: 12px;
}

.elapsed-time {
  color: var(--fg-40);
  font-size: var(--text-xs);
  font-family: var(--font-mono);
  padding: 2px 0 !important;
  margin: 0 0 4px 0 !important;
  position: relative;
  top: 0;
  border: none !important;
  display: block !important;
  opacity: 1 !important;
  visibility: visible !important;
}

.tool-result.success {
  background: rgba(var(--positive-rgb), 0.18);
  color: var(--positive-color);
  padding: 2px 4px;
  border-radius: 2px;
}

.tool-result.error {
  background: transparent;
  color: var(--color-magenta);
}

.tool-result.collapsed {
  background: transparent;
  color: var(--fg-40);
  font-style: italic;
}

.tool-result.minimal {
  background: transparent;
  color: var(--fg-40);
  opacity: 0.6;
  font-size: var(--text-sm);
  padding: 0;
}

/* Read output styling - reduced opacity since reads are less important */
.tool-result.read-output {
  display: block !important;
  background: transparent;
  border: none;
  padding: 0;
  margin: 0;
}

.read-content {
  margin: 0;
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  color: rgba(var(--foreground-rgb), 0.6);
  white-space: pre;
  overflow-x: auto;
  scrollbar-width: thin;
}

.read-line,
.search-line,
.result-line {
  display: flex;
  line-height: 1.4;
}

.read-line .line-number,
.search-line .line-number,
.result-line .line-number {
  display: none; /* Hide line numbers */
  width: 40px;
  text-align: right;
  padding-right: 8px;
  color: rgba(var(--foreground-rgb), 0.3);
  flex-shrink: 0;
  font-size: var(--text-sm);
  font-family: var(--font-mono);
}

.read-line .line-text,
.search-line .line-text,
.result-line .line-text {
  flex: 1;
  white-space: pre;
}

/* Bash command output */
.tool-result.bash-output {
  display: block;
  margin: 0;
  opacity: 1;
}

/* Bash output content - uses foreground/negative mix (override global pre) */
pre.bash-content,
.tool-result .bash-content,
.bash-content {
  background: transparent;
  border: none;
  border-radius: 0;
  padding: 0;
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  color: color-mix(in srgb, var(--foreground-color) 50%, var(--negative-color) 50%);
  white-space: pre;
  max-height: 400px;
  overflow-x: auto;
  padding: 4px 8px;
  background: rgba(var(--foreground-rgb), 0.03);
  overflow-y: auto;
  margin: 0;
  display: block;
  scrollbar-width: thin;
}

.bash-more {
  display: block;
  margin-top: 2px;
  font-size: var(--text-sm);
  color: rgba(128, 128, 128, 0.6);
  font-family: var(--font-mono);
  cursor: default;
  opacity: 0.8;
}

/* Search output styling */
.tool-result.search-output,
.tool-result.generic-output {
  display: block !important;
  background: transparent;
  border: none;
  padding: 0;
  margin: 0;
}

.search-content {
  margin: 0;
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  color: rgba(var(--foreground-rgb), 0.6);
  white-space: pre;
  overflow-x: auto;
  scrollbar-width: thin;
}

/* Bash command output styling */
.bash-output {
  background: rgba(var(--foreground-rgb), 0.03);
  margin-bottom: 4px;
}

.bash-more {
  display: block;
  margin-top: 4px;
  font-size: var(--text-sm);
  color: rgba(var(--foreground-rgb), 0.5);
  font-family: var(--font-mono);
}

.bash-more.clickable {
  cursor: pointer;
}

.bash-more.clickable:hover {
  color: var(--accent-color);
}

.read-more, .search-more, .result-more {
  display: block;
  margin-top: 4px;
  font-size: var(--text-xs);
  color: rgba(var(--foreground-rgb), 0.4);
  font-family: var(--font-mono);
  cursor: default;
}

/* ===== COLLAPSIBLE TOOL RESULTS ===== */
.tool-result.collapsible {
  display: block;
  user-select: none;
  cursor: default;
  font-size: var(--text-xs) !important;
  line-height: var(--leading-relaxed);
}

.tool-result.collapsible .collapsible-header {
  color: rgba(var(--positive-rgb), .8);
  display: flex;
  flex-wrap: wrap;
  gap: 0 4px;
  cursor: default;
  user-select: none;
  opacity: 1;
  overflow: visible;
  font-size: var(--text-xs);
}

.tool-result.collapsible .collapsible-header:hover .collapsible-icon,
.tool-result.collapsible .collapsible-header:hover .collapsible-summary,
.tool-result.collapsible .collapsible-header:hover .collapsible-detail,
.tool-result.collapsible .collapsible-header:hover .collapse-chevron {
  color: var(--positive-color);
}

.tool-result.collapsible .collapse-chevron {
  display: flex;
  color: rgba(var(--positive-rgb), 0.5);
  flex-shrink: 0;
}

.collapsible-icon {
  opacity: 1;
  color: rgba(var(--positive-rgb), 1);
}

.tool-result.collapsible .collapsible-summary {
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  color: rgba(var(--positive-rgb), 0.8);
}

.tool-result.collapsible .collapsible-detail {
  font-family: var(--font-mono);
  color: rgba(var(--positive-rgb), 0.9);
  overflow: visible;
  white-space: nowrap;
}

.tool-result.collapsible.collapsed .collapsible-content {
  display: none;
}

.tool-result.collapsible.expanded .collapsible-content {
  margin-top: 4px;
}

/* Allow text selection within collapsible content */
.collapsible-content,
.collapsible-content pre,
.collapsible-content code,
.collapsible-content .read-content,
.collapsible-content .search-content,
.collapsible-content .file-list-content,
.collapsible-content .dir-content,
.collapsible-content .result-content,
.collapsible-content .bash-content,
.collapsible-content .task-content,
.collapsible-content .web-search-content,
.collapsible-content .web-fetch-content {
  user-select: text;
  -webkit-user-select: text;
  cursor: text;
}

hr {
  opacity: .4;
}

/* Read output styling */
.tool-result.read-output .read-content {
  margin: 0;
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  color: rgba(var(--foreground-rgb), 0.6);
  white-space: pre;
  overflow-x: auto;
  scrollbar-width: thin;
  max-height: 80%;
  overflow-y: auto;
}

.tool-result.read-output .read-line {
  line-height: var(--leading-normal);
}

.result-icon {
  font-size: var(--text-base);
}

.result-icon.success {
  color: var(--positive-color);
}

.result-text {
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  color: rgba(var(--foreground-rgb), 0.7);
}

/* ===== TOOL-SPECIFIC RESULT STYLES ===== */

/* Write Output with Preview */
.tool-result.write-output {
  display: block;
}

.write-header {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 4px;
}

.write-path {
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  color: var(--positive-color);
}

.write-info {
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  color: rgba(var(--foreground-rgb), 0.4);
  margin-left: auto;
}

.write-preview {
  margin: 0;
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  background: rgba(var(--positive-rgb), 0.05);
  padding: 4px 8px;
  border-radius: 4px;
}

.write-line {
  display: flex;
  line-height: var(--leading-normal);
}

.write-line .line-number {
  color: rgba(var(--foreground-rgb), 0.3);
  margin-right: 8px;
  user-select: none;
}

.write-line .line-text {
  color: rgba(var(--foreground-rgb), 0.7);
}

/* Bash Output */
.tool-result.bash-output .bash-command {
  display: flex;
  flex-wrap: wrap;
  align-items: baseline;
  gap: 0 4px;
  padding: 4px 8px;
  background: rgba(var(--foreground-rgb), 0.03);
  border-top-left-radius: 2px;
  border-top-right-radius: 2px;
}

.bash-prompt {
  color: var(--negative-color);
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  font-weight: 600;
}

.bash-cmd {
  color: rgba(var(--foreground-rgb), 0.8);
  font-family: var(--font-mono);
  font-size: var(--text-xs);
}

.bash-line {
  color: rgba(var(--foreground-rgb), 0.7);
  font-size: var(--text-sm);
  line-height: var(--leading-normal);
}

/* Search Output (Grep) */
.tool-result.search-output .search-header {
  display: flex;
  flex-wrap: wrap;
  align-items: baseline;
  gap: 0 6px;
  margin-bottom: 4px;
  color: rgba(var(--foreground-rgb), 0.5);
}

.search-pattern {
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  color: var(--accent-color);
}

.tool-result .search-count {
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  color: rgba(var(--foreground-rgb), 0.4);
  margin-left: auto;
}

.search-line {
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  color: rgba(var(--foreground-rgb), 0.7);
  line-height: var(--leading-normal);
}

/* File List (Glob) */
.tool-result.file-list {
  display: block;
}

.file-list-header {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 4px;
  color: rgba(var(--foreground-rgb), 0.5);
}

.file-pattern {
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  color: var(--accent-color);
}

.tool-result .file-count {
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  color: rgba(var(--foreground-rgb), 0.4);
  margin-left: auto;
}

.file-list-content {
  margin: 0;
  font-family: var(--font-mono);
  font-size: var(--text-sm);
}

.file-item {
  color: rgba(var(--foreground-rgb), 0.7);
  line-height: var(--leading-normal);
}

/* Directory Listing (LS) */
.tool-result.dir-listing {
  display: block;
}

.dir-header {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 4px;
  color: rgba(var(--foreground-rgb), 0.5);
}

.dir-path {
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  color: var(--accent-color);
}

.tool-result .dir-count {
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  color: rgba(var(--foreground-rgb), 0.4);
  margin-left: auto;
}

.dir-content {
  margin: 0;
  font-family: var(--font-mono);
  font-size: var(--text-sm);
}

.dir-item {
  color: rgba(var(--foreground-rgb), 0.7);
  line-height: var(--leading-normal);
}

/* Web Search */
.tool-result.web-search {
  display: block;
}

.web-search-header {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 4px;
  color: rgba(var(--foreground-rgb), 0.5);
}

.web-query {
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  color: var(--accent-color);
}

.web-search-content {
  margin: 0;
  font-family: var(--font-mono);
  font-size: var(--text-sm);
}

.web-result-line {
  color: rgba(var(--foreground-rgb), 0.7);
  line-height: var(--leading-normal);
}

/* Web Fetch */
.tool-result.web-fetch {
  display: block;
}

.web-fetch-header {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 4px;
  color: rgba(var(--foreground-rgb), 0.5);
}

.web-url {
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  color: var(--accent-color);
}

.web-fetch-content {
  margin: 0;
  font-family: var(--font-mono);
  font-size: var(--text-sm);
}

.web-line {
  color: rgba(var(--foreground-rgb), 0.7);
  line-height: var(--leading-normal);
}

/* Task Result */
.tool-result.task-result {
  display: block;
}

.task-header {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 4px;
  color: rgba(var(--foreground-rgb), 0.5);
}

.task-desc {
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  color: var(--accent-color);
}

.task-type {
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  color: rgba(var(--foreground-rgb), 0.4);
  padding: 1px 6px;
  background: rgba(var(--foreground-rgb), 0.05);
  border-radius: 3px;
  margin-left: auto;
}

.task-content {
  margin: 0;
  font-family: var(--font-mono);
  font-size: var(--text-sm);
}

.task-line {
  color: rgba(var(--foreground-rgb), 0.7);
  line-height: var(--leading-normal);
}

/* Background Agent Launch */
.tool-result.task-result.background-agent {
  padding: 4px 0;
}

.tool-result.task-result.background-agent .task-header {
  margin-bottom: 2px;
}

.tool-result.task-result.background-agent .agent-id {
  font-size: var(--text-xs);
  color: rgba(var(--foreground-rgb), 0.4);
  margin-left: 4px;
}

.task-status {
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  color: var(--color-blue);
  opacity: 0.8;
}

/* Agent Launch Display */
.agent-launch {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 2px 0;
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  color: rgba(var(--foreground-rgb), 0.5);
}

.agent-launch-icon {
  color: var(--color-blue);
  flex-shrink: 0;
}

.agent-launch-type {
  color: rgba(var(--foreground-rgb), 0.8);
}

.agent-launch-id {
  color: rgba(var(--foreground-rgb), 0.4);
  font-size: var(--text-xs);
}

.agent-launch-status {
  color: var(--color-blue);
  margin-left: auto;
}

/* TaskOutput Result - Agent Progress Display */
.tool-result.taskoutput-result {
  display: block;
  padding: 4px 0;
}

.taskoutput-header {
  display: flex;
  align-items: center;
  gap: 4px;
}

.taskoutput-header .status-icon {
  flex-shrink: 0;
}

.taskoutput-header .status-icon.running {
  color: var(--color-blue);
  animation: pulse 1.5s ease-in-out infinite;
}

.taskoutput-header .status-icon.complete {
  color: var(--color-green);
}

.taskoutput-header .status-icon.error {
  color: var(--color-magenta);
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.4; }
}

.taskoutput-status {
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  color: rgba(var(--foreground-rgb), 0.5);
}

.taskoutput-id {
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  color: rgba(var(--foreground-rgb), 0.4);
  margin-left: auto;
}

.taskoutput-tools {
  display: flex;
  flex-direction: column;
  gap: 1px;
  margin-top: 2px;
}

.taskoutput-hidden {
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  color: rgba(var(--foreground-rgb), 0.3);
  padding: 2px 0;
}

.taskoutput-tool-call {
  display: flex;
  align-items: center;
  gap: 6px;
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  color: rgba(var(--foreground-rgb), 0.6);
}

.taskoutput-tool-call .tool-name {
  color: rgba(var(--foreground-rgb), 0.7);
}

.taskoutput-tool-call .tool-detail {
  color: rgba(var(--foreground-rgb), 0.6);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  max-width: 300px;
}

/* Simple Confirmation (ExitPlanMode, KillBash) */
.tool-result.simple-confirm {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 4px 0;
}

.tool-result.simple-confirm .result-text {
  color: rgba(var(--foreground-rgb), 0.6);
}

/* Generic Output - Clean without line numbers */
.tool-result.generic-output .result-line {
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  color: rgba(var(--foreground-rgb), 0.7);
  line-height: var(--leading-normal);
}

/* Result Messages */
.message.result-success {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 4px;
  padding: 12px 0;
  color: var(--accent-color);
  font-size: var(--text-base);
  border-top: 1px solid rgba(var(--accent-rgb), 0.1);
  margin-top: 12px;
}

.result-text-content {
  color: rgba(var(--foreground-rgb), 0.9);
  font-size: var(--text-base);
  font-family: var(--font-mono);
  margin-bottom: 4px;
}

.message.result-error {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  background: rgba(255, 153, 153, 0.05);
  border: none;
  border-radius: 8px;
  color: var(--color-magenta);
  font-size: var(--text-base);
}

.error-icon {
  color: rgba(255, 230, 153, 0.8);
  vertical-align: middle;
}

.result-summary {
  margin-top: 4px;
  padding: 8px 12px;
  background: rgba(255, 153, 204, 0.05);
  border-radius: 8px;
  font-size: var(--text-base);
  line-height: var(--leading-normal);
}

/* Permission Messages */
.message.permission-request {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  background: rgba(255, 153, 153, 0.05);
  border: none;
  border-radius: 8px;
  margin: 4px 0;
}

.permission-icon {
  color: rgba(255, 230, 153, 0.8);
  vertical-align: middle;
}

.permission-text {
  color: var(--color-magenta);
  font-size: var(--text-base);
}

/* Tool Approval */
.message.tool-approval {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 4px 8px;
  font-size: var(--text-base);
  color: var(--fg-60);
  opacity: 0.7;
}

.approval-icon {
  vertical-align: middle;
}

.approval-icon.approved {
  color: rgba(255, 230, 153, 0.7);
}

.approval-icon.denied {
  color: rgba(255, 230, 153, 0.5);
}

/* Streaming Indicator */
.streaming-loader {
  display: inline-block;
  color: var(--fg-40);
  opacity: 1;
  animation: spin 1s linear infinite;
  margin-left: 6px;
  vertical-align: middle;
}

@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@keyframes breathing {
  0%, 100% { 
    opacity: 0.3;
    transform: scale(0.8);
  }
  50% { 
    opacity: 1;
    transform: scale(1);
  }
}

/* Animations */
@keyframes messageSlide {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes resultSlide {
  from {
    opacity: 0;
    transform: translateX(-10px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.8; }
}

/* File Diff Styles */
.tool-result.file-diff {
  display: block !important;
  background: transparent;
  border: none;
  padding: 0;
  margin: 0;
  max-width: 100%;
  overflow-x: auto;
  scrollbar-width: thin;
}

.diff-content {
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  line-height: var(--leading-normal);
  color: var(--fg-60);
  white-space: pre;
  overflow-x: auto;
  margin: 0;
  background: transparent;
  border: none;
  padding: 0;
  scrollbar-width: thin;
}

/* Todo Write Styles - Minimal Dark */
.tool-use.todo-write {
  flex-direction: column;
  align-items: stretch;
  background: transparent;
  border: none;
  padding: 0;
  border-radius: 0;
}

.tool-use.todo-write.standalone {
  width: 100%;
  background: transparent;
  padding: 4px 0;
}

.todo-header {
  display: flex;
  align-items: center;
  gap: 6px;
  margin: 0;
  padding: 0;
  border-bottom: none;
}

.todo-header-icon {
  color: var(--accent-color);
}

.todo-list {
  display: flex;
  margin-top: 4px;
  flex-direction: column;
  gap: 2px;
}

.todo-item {
  display: flex;
  align-items: flex-start;
  gap: 8px;
  padding: 0;
  border-radius: 4px;
  font-size: var(--text-base);
  line-height: var(--leading-normal);
  color: var(--fg-80);
}

.todo-icon {
  flex-shrink: 0;
}

.todo-icon.completed {
  color: var(--positive-color); /* positive color for completed */
}

.todo-icon.progress {
  color: var(--accent-color); /* accent color for active tasks */
}

.todo-icon.pending {
  color: var(--fg-40); /* grey for pending tasks */
}

.todo-item.completed {
  opacity: 1;
}

.todo-item.completed .todo-content {
  text-decoration: none;
  color: var(--positive-color);
  opacity: 1;
}

.todo-item.in_progress {
  background: transparent;
}

.todo-item.in_progress .todo-content {
  color: var(--accent-color);
}

.todo-item.pending {
  opacity: 1;
}

.todo-item.pending .todo-content {
  color: var(--fg-80);
}

.todo-content {
  flex: 1;
  line-height: var(--leading-normal);
  font-family: var(--font-sans);
}

.tool-use.todo-write .tool-action {
  color: var(--accent-color);
  font-size: var(--text-sm);
  font-weight: 500;
}

.tool-use.todo-write .tool-detail {
  color: rgba(var(--foreground-rgb), 0.8);
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  opacity: 1;
}

/* Override selection color for all message content */
.message-content ::selection,
.message-content *::selection,
.markdown-content ::selection,
.markdown-content *::selection,
pre ::selection,
pre *::selection,
code ::selection,
code *::selection {
  background: rgba(var(--accent-rgb), 0.25) !important;
  color: var(--color-text-primary) !important;
}

.message-content ::-moz-selection,
.message-content *::-moz-selection,
.markdown-content ::-moz-selection,
.markdown-content *::-moz-selection,
pre ::-moz-selection,
pre *::-moz-selection,
code ::-moz-selection,
code *::-moz-selection {
  background: rgba(var(--accent-rgb), 0.25) !important;
  color: var(--color-text-primary) !important;
}

/* Tool result scrollbar styling - consolidated below */

/* System Message Styles */
.system-compact,
.system-rate-limit {
  margin: 8px 0;
  padding: 0;
}

.compact-message,
.rate-limit-message {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: var(--text-base);
  color: var(--fg-60);
  background: rgba(var(--foreground-rgb), 0.03);
  border: 1px solid rgba(var(--foreground-rgb), 0.05);
}

.compact-message {
  color: var(--color-cyan);
  border-color: rgba(var(--cyan-rgb), 0.2);
  background: rgba(var(--cyan-rgb), 0.05);
}

.compact-icon {
  font-size: var(--text-base);
}

.rate-limit-message {
  color: var(--color-magenta);
  border-color: rgba(255, 153, 204, 1);
  background: rgba(255, 153, 204, 1);
}

.rate-limit-message svg {
  color: var(--color-magenta);
}

/* Markdown Table Styles */
.table-wrapper {
  overflow-x: auto;
  overflow-y: hidden;
  margin: 4px 0;
  max-width: 100%;
  width: 100%;
  display: block;
  scrollbar-width: thin;
}

.markdown-table {
  border-collapse: collapse;
  font-size: var(--text-sm);
  font-family: var(--font-mono);
  white-space: nowrap;
}

.markdown-table th,
.markdown-table td {
  padding: 2px 6px;
  text-align: left;
}


.markdown-table th:not(:first-child),
.markdown-table td:not(:first-child) {
  border-left: 1px solid rgba(var(--foreground-rgb), 0.05);
}

.markdown-table {
  background: var(--bg-brighter-alpha);
  margin-bottom: 4px;
}

.markdown-table th {
  background: rgba(var(--foreground-rgb), 0.05);
  color: rgba(var(--foreground-rgb), 0.9);
  font-weight: 600;
}

.markdown-table td {
  color: rgba(var(--foreground-rgb), 0.7);
}

.markdown-table tr:nth-child(even) td {
  background: rgba(var(--foreground-rgb), 0.02);
}

/* 3px minimal scrollbars with 50% opacity foreground and background */
.table-wrapper::-webkit-scrollbar,
.messages-virtualized::-webkit-scrollbar,
.markdown-content::-webkit-scrollbar,
.code-block-wrapper::-webkit-scrollbar,
.result-content::-webkit-scrollbar,
.tool-result::-webkit-scrollbar,
.file-list-content::-webkit-scrollbar,
.search-output::-webkit-scrollbar,
.search-content::-webkit-scrollbar,
.diff-content::-webkit-scrollbar,
.bash-output::-webkit-scrollbar,
.message-content::-webkit-scrollbar,
.message-bubble::-webkit-scrollbar,
.message::-webkit-scrollbar,
pre::-webkit-scrollbar {
  height: 3px;
  width: 3px;
}

.table-wrapper::-webkit-scrollbar-track,
.messages-virtualized::-webkit-scrollbar-track,
.markdown-content::-webkit-scrollbar-track,
.code-block-wrapper::-webkit-scrollbar-track,
.result-content::-webkit-scrollbar-track,
.tool-result::-webkit-scrollbar-track,
.file-list-content::-webkit-scrollbar-track,
.search-output::-webkit-scrollbar-track,
.search-content::-webkit-scrollbar-track,
.diff-content::-webkit-scrollbar-track,
.bash-output::-webkit-scrollbar-track,
.message-content::-webkit-scrollbar-track,
.message-bubble::-webkit-scrollbar-track,
.message::-webkit-scrollbar-track,
pre::-webkit-scrollbar-track {
  background: rgba(var(--foreground-rgb), 0.05);
}

.table-wrapper::-webkit-scrollbar-thumb,
.messages-virtualized::-webkit-scrollbar-thumb,
.markdown-content::-webkit-scrollbar-thumb,
.code-block-wrapper::-webkit-scrollbar-thumb,
.result-content::-webkit-scrollbar-thumb,
.tool-result::-webkit-scrollbar-thumb,
.file-list-content::-webkit-scrollbar-thumb,
.search-output::-webkit-scrollbar-thumb,
.search-content::-webkit-scrollbar-thumb,
.diff-content::-webkit-scrollbar-thumb,
.bash-output::-webkit-scrollbar-thumb,
.message-content::-webkit-scrollbar-thumb,
.message-bubble::-webkit-scrollbar-thumb,
.message::-webkit-scrollbar-thumb,
pre::-webkit-scrollbar-thumb {
  background: rgba(var(--foreground-rgb), 0.5);
  border-radius: 4px;
}

.table-wrapper::-webkit-scrollbar-thumb:hover,
.messages-virtualized::-webkit-scrollbar-thumb:hover,
.markdown-content::-webkit-scrollbar-thumb:hover,
.code-block-wrapper::-webkit-scrollbar-thumb:hover,
.result-content::-webkit-scrollbar-thumb:hover,
.tool-result::-webkit-scrollbar-thumb:hover,
.file-list-content::-webkit-scrollbar-thumb:hover,
.search-output::-webkit-scrollbar-thumb:hover,
.search-content::-webkit-scrollbar-thumb:hover,
.diff-content::-webkit-scrollbar-thumb:hover,
.bash-output::-webkit-scrollbar-thumb:hover,
.message-content::-webkit-scrollbar-thumb:hover,
.message-bubble::-webkit-scrollbar-thumb:hover,
.message::-webkit-scrollbar-thumb:hover,
pre::-webkit-scrollbar-thumb:hover {
  background: rgba(var(--foreground-rgb), 0.7);
}

/* Tool output font size override - 9px for all tool results, 8px for line numbers */
.tool-result,
.tool-result .result-content,
.tool-result .bash-line,
.tool-result .bash-command-text,
.tool-result .read-line,
.tool-result .search-line,
.tool-result .result-line,
.tool-result .file-item,
.tool-result .dir-item,
.tool-result .web-result-line,
.tool-result .web-line,
.tool-result .task-line,
.tool-result .result-text,
.tool-result .search-pattern,
.tool-result .bash-content,
.tool-result .read-content,
.tool-result .search-content,
.tool-result .file-list-content,
.tool-result .dir-content,
.tool-result .web-search-content,
.tool-result .web-fetch-content,
.tool-result .task-content,
.diff-line,
.diff-content,
.diff-container,
.line-content,
.code-block-wrapper,
.code-block-wrapper code,
.code-block-wrapper pre,
pre code,
.thinking-code-block,
.thinking-code-block code {
  font-size: var(--text-xs);
}

/* Line numbers - 8px */
.tool-result .line-number,
.read-line .line-number,
.bash-line .line-number,
.search-line .line-number,
.result-line .line-number,
.diff-line .line-number,
.line-number,
.react-syntax-highlighter-line-number,
.linenumber {
  font-size: 8px !important;
}

/* Rainbow gradient animation for ultrathink in user messages */
.ultrathink-text {
  background: linear-gradient(
    90deg,
    #ff9999,
    #ffbb99,
    #ffdd99,
    #ffff99,
    #99ff99,
    #99ffdd,
    #99ffff,
    #99bbff,
    #c4b5ff,
    #ff99dd,
    #ff9999
  );
  background-size: 300% 100%;
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  animation: rainbow-flow 3s linear infinite;
}

@keyframes rainbow-flow {
  0% {
    background-position: 0% 50%;
  }
  100% {
    background-position: 300% 50%;
  }
}

/* 
   Compact Summary - minimal yume style
    */

.compact-summary-card {
  padding: 8px 0;
  margin: 4px 0;
  font-family: var(--font-mono);
}

.compact-summary-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 8px;
}

.compact-summary-icon {
  color: rgba(var(--foreground-rgb), 0.4);
  flex-shrink: 0;
}

.compact-summary-title {
  font-size: var(--text-sm);
  font-weight: 400;
  color: rgba(var(--foreground-rgb), 0.6);
  text-transform: lowercase;
}

.compact-summary-subtitle {
  display: none;
}

.compact-stats {
  display: flex;
  gap: 16px;
  margin-bottom: 8px;
}

.compact-stat {
  display: flex;
  align-items: baseline;
  gap: 4px;
}

.compact-stat-value {
  font-size: var(--text-base);
  font-weight: 400;
  color: rgba(var(--foreground-rgb), 0.7);
  font-family: var(--font-mono);
}

.compact-stat-value.highlight {
  color: rgba(var(--foreground-rgb), 0.7);
}

.compact-stat-label {
  font-size: var(--text-xs);
  color: rgba(var(--foreground-rgb), 0.4);
  text-transform: lowercase;
}

.compact-summary-content {
  padding: 0;
  margin-top: 8px;
}

.compact-summary-label {
  font-size: var(--text-xs);
  color: rgba(var(--foreground-rgb), 0.4);
  text-transform: lowercase;
  margin-bottom: 4px;
  display: flex;
  align-items: center;
  gap: 4px;
}

.compact-summary-text {
  font-size: var(--text-base);
  line-height: var(--leading-normal);
  color: rgba(var(--foreground-rgb), 0.6);
  white-space: pre-wrap;
  word-break: break-word;
}

.compact-summary-text p {
  margin: 0 0 2px 0;
}

.compact-summary-text p:last-child {
  margin-bottom: 0;
}

.compact-summary-text strong {
  color: rgba(var(--foreground-rgb), 0.7);
  font-weight: 500;
}

.compact-summary-text ul,
.compact-summary-text ol {
  margin: 4px 0;
  padding-left: 16px;
}

.compact-summary-text li {
  margin: 2px 0;
}

.compact-summary-text code {
  background: rgba(var(--foreground-rgb), 0.05);
  padding: 1px 3px;
  font-size: var(--text-sm);
  font-family: var(--font-mono);
  color: var(--code-color);
}

/* Compact fallback for simple messages */
.compact-summary-simple {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 4px 0;
  margin: 4px 0;
}

.compact-summary-simple-icon {
  color: rgba(var(--foreground-rgb), 0.4);
  flex-shrink: 0;
}

.compact-summary-simple-text {
  font-size: var(--text-sm);
  color: rgba(var(--foreground-rgb), 0.5);
}

.compact-summary-simple-tokens {
  font-weight: 400;
  color: rgba(var(--foreground-rgb), 0.6);
  font-family: var(--font-mono);
}

/* Word wrap toggle for all chat content - applied when html element has .word-wrap class */
/* Code blocks and pre-formatted content */
:root.word-wrap .markdown-content pre,
:root.word-wrap .markdown-content pre code,
:root.word-wrap .code-block-pre,
:root.word-wrap .code-block-pre code,
:root.word-wrap .thinking-code-block,
:root.word-wrap .thinking-code-block code,
:root.word-wrap .thinking-code-pre,
:root.word-wrap .thinking-code,
:root.word-wrap .bash-output-content,
:root.word-wrap .tool-result-content pre,
:root.word-wrap .tool-result.standalone .result-content,
:root.word-wrap .line-content,
:root.word-wrap .edit-content-line,
:root.word-wrap .write-content,
:root.word-wrap .diff-content,
:root.word-wrap .diff-text,
:root.word-wrap .edit-content,
:root.word-wrap .edit-diff pre,
:root.word-wrap pre.edit-diff,
:root.word-wrap .read-content,
:root.word-wrap .search-content,
:root.word-wrap .bash-content,
:root.word-wrap pre.bash-content,
:root.word-wrap .file-list-content,
:root.word-wrap .dir-content,
:root.word-wrap .web-search-content,
:root.word-wrap .web-fetch-content,
:root.word-wrap .task-content {
  white-space: pre-wrap !important;
  word-wrap: break-word !important;
  overflow-wrap: break-word !important;
  word-break: break-word !important;
}

/* Inline code */
:root.word-wrap .markdown-content code,
:root.word-wrap .message-text code,
:root.word-wrap .thinking-inline-code {
  white-space: pre-wrap !important;
  word-wrap: break-word !important;
  overflow-wrap: break-word !important;
  word-break: break-word !important;
}

/* Console/bash output and tool results */
:root.word-wrap .bash-line,
:root.word-wrap .bash-command-text,
:root.word-wrap .bash-output-line,
:root.word-wrap .result-content,
:root.word-wrap .tool-result,
:root.word-wrap .tool-result-content,
:root.word-wrap .read-line .line-text,
:root.word-wrap .search-line .line-text,
:root.word-wrap .result-line .line-text,
:root.word-wrap .bash-line .line-text,
:root.word-wrap .file-item,
:root.word-wrap .dir-item,
:root.word-wrap .web-result-line,
:root.word-wrap .web-line,
:root.word-wrap .task-line,
:root.word-wrap .tool-detail,
:root.word-wrap .collapsible-detail {
  white-space: pre-wrap !important;
  word-wrap: break-word !important;
  overflow-wrap: break-word !important;
  word-break: break-word !important;
}

/* Message content and markdown text */
:root.word-wrap .message-content,
:root.word-wrap .message-text,
:root.word-wrap .markdown-content,
:root.word-wrap .markdown-content p,
:root.word-wrap .thinking-content,
:root.word-wrap .thinking-text {
  word-wrap: break-word !important;
  overflow-wrap: break-word !important;
  word-break: break-word !important;
}

/* Diff/edit container adjustments for word wrap */
:root.word-wrap .diff-container,
:root.word-wrap .diff-content,
:root.word-wrap .edit-content,
:root.word-wrap .code-block-wrapper,
:root.word-wrap .tool-result,
:root.word-wrap .read-content,
:root.word-wrap .search-content,
:root.word-wrap .bash-content,
:root.word-wrap pre.bash-content,
:root.word-wrap .file-list-content,
:root.word-wrap .dir-content,
:root.word-wrap .table-wrapper {
  overflow-x: hidden !important;
}

:root.word-wrap .diff-hunk,
:root.word-wrap .edit-line {
  min-width: 0;
  display: block;
}

:root.word-wrap .diff-line,
:root.word-wrap .edit-line {
  min-width: 0;
  flex-wrap: wrap;
}

/* Generic pre elements in chat */
:root.word-wrap .message pre,
:root.word-wrap .message-bubble pre,
:root.word-wrap .message-content pre {
  white-space: pre-wrap !important;
  word-wrap: break-word !important;
  overflow-wrap: break-word !important;
  word-break: break-word !important;
  overflow-x: hidden !important;
}

/* 
   Line height for code elements - uses the user's line-height setting
    */
pre,
code,
.code-block-pre,
.code-block-pre code,
.code-block-wrapper code,
.code-block-wrapper pre,
pre code,
.markdown-content pre,
.markdown-content pre code,
.markdown-content code,
.thinking-code-pre,
.thinking-code,
.thinking-code-block code,
.thinking-markdown pre,
.thinking-markdown pre code,
.thinking-markdown code,
.thinking-text,
.thinking-content,
.bash-output-content,
.bash-content,
.line-content,
.diff-content,
.edit-content,
.read-content,
.search-content,
.result-content {
  line-height: var(--leading-normal);
}